---
title: "spatialBehaviour"
output: html_document
date: "2023-03-03"
---

``` {r}
library(StormR)
```

The `spatialBehaviour` function allows computing wind speed and direction for each cell of a regular grid (i.e., a raster) for a given tropical cyclone or set of tropical cyclones. The `product="Profiles` argument allows producing 2D wind fields at any time. The function also allows to compute the associated maximum sustained wind speed (`product="MSW`), the power dissipation index (`product="PDI`) and the duration of exposure to winds reaching defined speed thresholds along the life span of the cyclones (`product="Exposure`). Then the `plotBehaviour` and the `writeRast` functions can be used to visualise and export the output products.

### Computing and plotting wind behaviour

In the following example we compute the behaviour of winds generated by the topical cyclone Pam (2015) nearby the Vanuatu.

```{r}
st <- Storms(loi = "Vanuatu", names = "PAM")
plotStorms(st)
```

We can generate 2D wind fields at any time using the `spatialBehaviour` function with the `product="Profiles` argument as follows:

```{r}
pf <- spatialBehaviour(st,product="Profiles",verbose=0)
pf
```

The function returns a `SpatRaster` with two rasters, one for the wind speed and one for the wind direction, for each observation or interpolated observation. NAME OF THE STORM_Profiles or WindDirection_ID of the observation

```{r}
plotBehaviour(st,pf$"PAM_Profiles_38")
```

```{r}
pf <- spatialBehaviour(st,product="MWS",verbose=0)
pf
```


### Inspecting and exporting SpatialBehviour products
E.g. exporting the maximum sustained wind speed as a raster file in a given directory (here a temporary directory)

- Exemple de manipulation de rasters
``` r
writeRast(st_prod[["PAM_MSW"]], path = paste0(tempdir(),"/"))
```

