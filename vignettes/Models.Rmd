---
title: "Modeles"
output: html_document
date: "`r Sys.Date()`"
---

``` {r setup, include = FALSE}
library(StormR)
library(terra)
library(rworldxtra)
data("countriesHigh")
```

The main functions of the `StormR` package, i.e., the `SpatialBehaviour()` and `TemporalBehaviour()` functions, allow to compute summary statistics from wind speed and direction field computed using storm track data. Wind fields can be computed using different sets of parametric models. Three models described by Holland (1980), Willoughby et al. (2006), and Boose et al. (2004) are implemented. Those models compute radial wind speed $v_r$ (in $m.s^{-1}$) at the distance $r$ (in $km$) from the centre of the storm. In both the `SpatialBehaviour()` and `TemporalBehaviour()` functions the model can be defined using the `method` argument.

The original Holland (1980) and Willoughby et al. (2006) models are symmetrical, however winds are rarely symmetric around the centre of a storm, notably because of the translation movement of the storm. It is therefore more realistic to add asymmetry to the wind field generated by these models (Yan and Zhang, 2022). We implemented two formula to add asymmetry to Holland (1980) and Willoughby et al. (2006) models. These formula have been developed by Miyazaki et al. (1962) and Chen (1994) and can be `asymmetry` argument of the `SpatialBehaviour()` and `TemporalBehaviour()` functions.

The third model developed by Boose et al. (2004) is an asymmetrical version of the Holland (1980) model. Contrary to the Holland (1980) and Willoughby et al. (2006), this model has different parameter settings on water and lands. Below we describe the models and compared wind speed profiles generated by the different sets of models using the `SpatialBehaviour()` function and the `product="Profiles` argument. In these examples we use the track data for the tropical cyclone Pam (2015) provided in the `test_dataset` dataset of the package. 

```{r}
st <- Storms(loi = "Vanuatu", names = "PAM",verbose=0)
```

## Symetrical models

The two first models, i.e., Holland (1980), Willoughby et al. (2006), are widely used symmetrical models (Yan and Zhang, 2022).  

### Holland (1980)

$$
v_r = \sqrt{\frac{b}{\rho}\left(\frac{R_m}{r}\right)^b (p_{oci} - p_c)\exp\left(-\left(\frac{R_m}{r}\right)^b\right) + \left(\frac{rf}{2}\right)^2} - \left(\frac{rf}{2}\right)
$$

where <br />
$v_r$ is the radial wind speed (in $m.s^{-1}$) <br />
$r$ is the distance to the eye of the storm (in $km$) <br />
$v_m$ is the maximum sustained wind speed (in $m.s^{-1}$) <br />
$R_m$ is the radius of maximum sustained wind speed (in $km$) <br />
$p_c$ is the pressure at the centre of the storm ($pressure$ in $mb$) <br />
$p_{oci}$ is the pressure at outermost closed isobar of the storm (in $mb$) <br />
$\rho = 1.15$ is the air density (in $kg.m^{-3}$) <br />
$f = 2 \times 7.29 \times10^{-5} \sin(\phi)$ is the Coriolis force (in $N.kg^{-1}$, with $\phi$ being the latitude) <br />
$b = \frac{\rho e \times v_m^2}{p_{oci} - p_c}$ is the shape parameter <br />

### Boose et al. (2004)

$$
v_r = F\left[v_m - S(1 - \sin T)\frac{v_h}{2} \right] \times \sqrt{\left(\frac{R_m}{r}\right)^b \exp \left( 1 - \left(\frac{R_m}{r}\right)^b \right)}
$$

where <br />
$v_r$ is the radial wind speed (in $m.s^{-1}$) <br />
$v_h$ is the storm velocity (in $m.s^{-1}$) <br />
$r$ is the distance to the eye of the storm (in $km$) <br />
$v_m$ is the maximum sustained wind speed (in $m.s^{-1}$) <br />
$R_m$ is the radius of maximum sustained wind speed (in $km$) <br />
$p_c$ is the pressure at the center of the storm ($pressure$ in $mb$) <br />
$p_{oci}$ is the pressure at outermost closed isobar of the storm (in $mb$) <br />
$\rho = 1.15$ is the air density (in $kg.m^{-3}$) <br />
$b = \frac{\rho e \times v_m^2}{p_{oci} - p_c}$ is the shape parameter <br />
$F$ is a scaling parameter for friction ($1.0$ in water, $0.8$ in land) <br /> 
$S$ is a scaling parameter for asymmetry ($1.0$) <br /> 
$T$ Oriented angle (clockwise/counterclockwise in Northern/Southern Hemisphere) between forward path of the storm and a radial line from the eye of the
storm to point $r$ <br /> 


### Direction
Northern Hemisphere
$$
D = A_z - 90 - I
$$
Southern Hemisphere
$$
D = A_z + 90 + I
$$
where <br />
$D$ is the direction of the radial wind <br />
$A_z$ is the azimuth from point r to the eye of the storm <br />
$I$ is the cross isobar inflow angle ($20$ in water, $40$ in land) <br />


### Willoughby et al. (2006)

$$
\left\{
\begin{aligned}
v_r &= v_m\left(\frac{r}{R_m}\right)^{n} \quad if \quad r < R_m \\
v_r &= v_m\left((1-A)e^{-\frac{|r-R_m|}{X1}} + A e^{-\frac{|r-R_m|}{X2}}\right) \quad if \quad r \geq R_m \\
\end{aligned}
\right.
$$

where <br />
$v_r$ is the radial wind speed (in $m.s^{-1}$) <br />
$r$ is the distance to the eye of the storm (in $km$) <br />
$v_m$ is the maximum sustained wind speed (in $m.s^{-1}$) <br />
$R_m$ is the radius of maximum sustained wind speed (in $km$) <br />
$X1 = 287.6 - 1.942v_m + 7.799\ln(R_m) + 1.819|\phi|$<br />
$X2 = 25$ <br />
$n = 2.1340 + 0.0077v_m - 0.4522\ln(R_m) - 0.0038|\phi|$<br />
$A = 0.5913 + 0.0029v_m - 0.1361\ln(R_m) - 0.0042|\phi| (A\ge0)$<br />
$\phi$ is the latitude of the center of the storm 

Note that for both models if $R_m$ is not provided then it is approximated using an empirical formula derived from Willoughby et al. (2006)<br />
$R_m = 46.4e^{(-0.0155v_m + 0.0169|\phi|)}$

## Asymmetry


### General formula
$\vec{V} = \vec{V_c} = + C.\vec{V_t}$


### Miyazaki et al. 1962
$C = exp(-\frac{r}{500}\pi)$

### Chen 1994
$C = \frac{3R_m^{\frac{3}{2}}r^{\frac{3}{2}}}{R_m^3 + r^3 +R_m^{\frac{3}{2}}r^{\frac{3}{2}}}$



where <br />
$v_{r_{as}} \quad$ is the new radial wind speed with asymmetry $(m.s^{-1})$ <br />
$v_r \quad$ is the former radial wind speed without asymmetry $(m.s^{-1})$ <br />
$v_h \quad$ is the velocity of storm $(m.s^{-1})$ <br />
$S$ Asymmetry coefficient (usually set to 1) <br />
$\alpha \quad$ is tha angle between the storm direction and the point where $v_{r_{as}}$ is computed.
Clockwise in Nothern hemisphere, counterclokwise in Southern hemisphere. <br />

## Wind Direction

### Boose 
Northern Hemisphere
$D = A_z - 90 - I$ Northern Hemisphere
$D = A_z + 90 + I$ Southern Hemisphere

where <br />
$D$ is the direction of the radial wind <br />
$A_z$ is the azimuth from point r to the eye of the storm <br />
$I$ is the cross isobar inflow angle ($20$ in water, $40$ in land) <br />


```{r}
st <- Storms(loi = c(168.33,-17.73), names = "PAM",verbose=0)
PAM<-getObs(st,name="PAM")
par(mfrow=c(1,2))
pf <- spatialBehaviour(st,product="Profiles",method="Holland",asymmetry="None",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Holland (1980)",cex.main=0.8)
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
pf <- spatialBehaviour(st,product="Profiles",method="Willoughby",asymmetry="None",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Willoughby et al. (2006)",cex.main=0.8)
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
par(mfrow=c(1,2))
pf <- spatialBehaviour(st,product="Profiles",method="Holland",asymmetry="Miyazaki",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Holland (1980) + Miyazaki et al. (1962)",cex.main=0.8)
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
pf <- spatialBehaviour(st,product="Profiles",method="Willoughby",asymmetry="Miyazaki",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Willoughby et al. (2006) + Miyazaki et al. (1962)",cex.main=0.8)
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
par(mfrow=c(1,2))
pf <- spatialBehaviour(st,product="Profiles",method="Holland",asymmetry="Chen",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Holland (1980) + Chen (1994)",cex.main=0.8)
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
pf <- spatialBehaviour(st,product="Profiles",method="Willoughby",asymmetry="Chen",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Willoughby et al. (2006) + Chen (1994)",cex.main=0.8)
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
par(mfrow=c(1,2))
pf <- spatialBehaviour(st,product="Profiles",method="Boose",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Boose et al. (2004)",cex.main=0.8)
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
```



## References
* Boose, E. R., Chamberlin, K. E., & Foster, D. R. (2001). Landscape and Regional Impacts of Hurricanes in New England. Ecological Monographs, 71(1), Article 1. https://doi.org/10.1890/0012-9615(2001)071[0027:LARIOH]2.0.CO;2
 
* Holland, G. J. (1980). An Analytic Model of the Wind and Pressure Profiles in Hurricanes. Monthly Weather Review, 108(8), 1212–1218. https://doi.org/10.1175/1520-0493(1980)108<1212:AAMOTW>2.0.CO;2
 
* Willoughby, H. E., Darling, R. W. R., & Rahn, M. E. (2006). Parametric Representation of the Primary Hurricane Vortex. Part II: A New Family of Sectionally Continuous Profiles. Monthly Weather Review, 134(4), 1102–1120. https://doi.org/10.1175/MWR3106.1

* Yan, D., & Zhang, T. (2022). Research progress on tropical cyclone parametric wind field models and their application. Regional Studies in Marine Science, 51, 102207. https://doi.org/10.1016/j.rsma.2022.102207
