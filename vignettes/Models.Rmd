---
title: "Models"
output: html_document
date: "`r Sys.Date()`"
vignette: >
   %\VignetteIndexEntry{"Models"}
   %\VignetteEngine{knitr::rmarkdown}
   %\VignetteEncoding{UTF-8}
---



``` {r setup, include = FALSE}
library(StormR)
library(terra)
library(rworldxtra)
data("countriesHigh")
```

The main functions of the `StormR` package, i.e., the `SpatialBehaviour()` and `TemporalBehaviour()` functions, allow to compute summary statistics from wind speed and direction field computed using storm track data. Wind fields can be computed using different sets of parametric models. Three models described by Holland (1980), Willoughby et al. (2006), and Boose et al. (2004) are implemented in this package. Those models compute radial wind speed $v_r$ (in $m.s^{-1}$) at the distance $r$ (in $km$) from the centre of the storm. In both the `SpatialBehaviour()` and `TemporalBehaviour()` functions the model can be defined using the `method` argument.

The original Holland (1980) and Willoughby et al. (2006) models are symmetrical, however winds are rarely symmetric around the centre of a storm, notably because of the translation movement of the storm. It is therefore more realistic to add asymmetry to the wind field generated by these models (Yan and Zhang, 2022). We implemented two formula to add asymmetry to Holland (1980) and Willoughby et al. (2006) models. These formula have been developed by Miyazaki et al. (1962) and Chen (1994) and can be used using the `asymmetry` argument of the `SpatialBehaviour()` and `TemporalBehaviour()` functions.

The third model developed by Boose et al. (2004) is an asymmetrical version of the Holland (1980) model. Contrary to the Holland (1980) and Willoughby et al. (2006), this model has different parameter settings on water and lands. Below we describe the models and compared wind speed profiles generated by the different sets of models using the `SpatialBehaviour()` function and the `product="Profiles` argument. In these examples we use the track data for the tropical cyclone Pam (2015) provided in the `test_dataset` dataset of the package. 

```{r}
st <- Storms(loi = "Vanuatu", names = "PAM",verbose=0)
```

### Holland (1980) symmetric wind field

The Holland (1980) model is a simple model that only require few basic parameters and has a wide applicability.

$$
v_r = \sqrt{\frac{b}{\rho} \times \left(\frac{R_m}{r}\right)^b \times (p_{oci} - p_c) \times e^{-\left(\frac{R_m}{r}\right)^b} + \left(\frac{r \times f}{2}\right)^2} - \left(\frac{r \times f}{2}\right)
$$
where, <br />
$v_r$ is the radial wind speed (in $m.s^{-1}$) <br />
$r$ is the distance to the eye of the storm (in $km$) <br />
$R_m$ is the radius of maximum sustained wind speed (in $km$) <br />
$p_c$ is the pressure at the centre of the storm (in $mb$) <br />
$p_{oci}$ is the pressure at outermost closed isobar of the storm (in $mb$) <br />
$\rho$ is the air density set to $1.15 kg.m^{-3}$ <br />
$f = 2 \times 7.29 \times 10^{-5} \sin(\phi)$ is the Coriolis force (in $N.kg^{-1}$, with $\phi$ being the latitude) <br />
$b = \frac{\rho \times e \times v_m^2}{p_{oci} - p_c}$ is the shape parameter, with $e$ being the base of natural logarithms ~2.718282 and $v_m$ the maximum sustained wind speed (in $m.s^{-1}$) <br />
<br />

### Willoughby et al. (2006) symmetric wind field

The Willoughby et al. (2006) model is a two sections model in which wind increase as a power of radius inside the eye and decay exponentially outside the eye after a smooth polynomial transition across the eye wall (see also Willoughby 1995, Willoughby et al. 2004).

$$
\left\{
\begin{aligned}
v_r &= v_m \times \left(\frac{r}{R_m}\right)^{n} \quad if \quad r < R_m \\
v_r &= v_m \times \left((1-A) \times e^{-\frac{|r-R_m|}{X1}} + A \times e^{-\frac{|r-R_m|}{X2}}\right) \quad if \quad r \geq R_m \\
\end{aligned}
\right.
$$
where, <br />
$v_r$ is the radial wind speed (in $m.s^{-1}$) <br />
$r$ is the distance to the eye of the storm (in $km$) <br />
$v_m$ is the maximum sustained wind speed (in $m.s^{-1}$) <br />
$R_m$ is the radius of maximum sustained wind speed (in $km$) <br />
$X1 = 287.6 - 1.942 \times v_m + 7.799 \times \ln(R_m) + 1.819 \times |\phi|$<br />
$X2 = 25$ <br />
$n = 2.1340 + 0.0077 \times v_m - 0.4522 \times \ln(R_m) - 0.0038 \times |\phi|$<br />
$A = 0.5913 + 0.0029 \times v_m - 0.1361 \times \ln(R_m) - 0.0042 \times |\phi|$ and $A\ge0$<br />
$\phi$ is the latitude of the center of the storm 
<br />

### Adding asymmetry to Holland (1980) and Willoughby et al. (2006) wind fields

The asymmetry generated by the translation speed of the storm can be added as follows: 

$\vec{V} = \vec{V_c} + C \times \vec{V_t}$

where, <br />
$\vec{V}$ is the combined, asymmetric wind field <br />
$\vec{V_c}$ is symmetric wind field <br />
$\vec{V_t}$ is the translation speed of the storm <br />
$C$ is function of $r$, the distance to the eye of the storm (in $km$) <br />

#### Miyazaki et al. 1962
$C = e^{(-\frac{r}{500} \times \pi)}$
<br />

#### Chen 1994
$C = \frac{3 \times R_m^{\frac{3}{2}} \times r^{\frac{3}{2}}}{R_m^3 + r^3 +R_m^{\frac{3}{2}} \times r^{\frac{3}{2}}}$

where, <br />
$R_m$ is the radius of maximum sustained wind speed (in $km$) <br />
<br />

### Boose et al. (2004) asymmertric model

The Boose et al. (2004) model or "HURRECON" model is a modification of the Holland (1980) model (see also Boose et al. 2001). In addition to adding asymmetry this model also include a different parametrisation on lands and waters.

#### Wind speed

Wind speed is computed as follows,

$$
v_r = F\left(v_m - S \times (1 - \sin(T)) \times \frac{v_h}{2} \right) \times \sqrt{\left(\frac{R_m}{r}\right)^b \times e^{1 - \left(\frac{R_m}{r}\right)^b}}
$$

$v_r$ is the radial wind speed (in $m.s^{-1}$) <br />
$v_h$ is the storm velocity (in $m.s^{-1}$) <br />
$r$ is the distance to the eye of the storm (in $km$) <br />
$v_m$ is the maximum sustained wind speed (in $m.s^{-1}$) <br />
$R_m$ is the radius of maximum sustained wind speed (in $km$) <br />
$p_c$ is the pressure at the centre of the storm ($pressure$ in $mb$) <br />
$p_{oci}$ is the pressure at outermost closed isobar of the storm (in $mb$) <br />
$\rho = 1.15$ is the air density (in $kg.m^{-3}$) <br />
$b = \frac{\rho \times e \times v_m^2}{p_{oci} - p_c}$ is the shape parameter <br />
$F$ is a scaling parameter for friction ($1.0$ in water, $0.8$ in land) <br /> 
$S$ is a scaling parameter for asymmetry ($1.0$) <br /> 
$T$ oriented angle (clockwise/counter clockwise in Northern/Southern Hemisphere) between forward trajectory of the storm and a radial line from the eye of the storm to point $r$ <br /> 
$S$ Asymmetry coefficient (usually set to 1) <br />

#### Wind direction

Wind direction is computed as follows,

$$
\left\{
\begin{aligned}
D = A_z - 90 - I \quad if \quad \phi > 0 \quad(Northern \quad Hemispher) \\
D = A_z - 90 - I \quad if \quad \phi \leq 0 \quad(Southern \quad Hemispher) \\
\end{aligned}
\right.
$$
where <br />
$D$ is the direction of the radial wind <br />
$A_z$ is the azimuth from point r to the eye of the storm <br />
$I$ is the cross isobar inflow angle ($20$ in water, $40$ in land) <br />
$\phi$ is the latitude <br />

```{r}
st <- Storms(loi = c(168.33,-17.73), names = "PAM",verbose=0)
PAM<-getObs(st,name="PAM")
par(mfrow=c(1,2))
pf <- spatialBehaviour(st,product="Profiles",method="Holland",asymmetry="None",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Holland (1980)",cex.main=0.8,range=c(0,90))
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
pf <- spatialBehaviour(st,product="Profiles",method="Willoughby",asymmetry="None",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Willoughby et al. (2006)",cex.main=0.8,range=c(0,90))
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
par(mfrow=c(1,2))
pf <- spatialBehaviour(st,product="Profiles",method="Holland",asymmetry="Miyazaki",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Holland (1980) + Miyazaki et al. (1962)",cex.main=0.8,range=c(0,90))
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
pf <- spatialBehaviour(st,product="Profiles",method="Willoughby",asymmetry="Miyazaki",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Willoughby et al. (2006) + Miyazaki et al. (1962)",cex.main=0.8,range=c(0,90))
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
par(mfrow=c(1,2))
pf <- spatialBehaviour(st,product="Profiles",method="Holland",asymmetry="Chen",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Holland (1980) + Chen (1994)",cex.main=0.8,range=c(0,90))
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
pf <- spatialBehaviour(st,product="Profiles",method="Willoughby",asymmetry="Chen",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Willoughby et al. (2006) + Chen (1994)",cex.main=0.8,range=c(0,90))
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
par(mfrow=c(1,2))
pf <- spatialBehaviour(st,product="Profiles",method="Boose",verbose=0)
terra::plot(pf$PAM_Speed_41,main="Boose et al. (2004)",cex.main=0.8,range=c(0,90))
terra::plot(countriesHigh,add=TRUE)
lines(PAM$lon,PAM$lat,lty=3)
```

## References
* Boose, E. R., Chamberlin, K. E., & Foster, D. R. (2001). Landscape and Regional Impacts of Hurricanes in New England. Ecological Monographs, 71(1), Article 1. https://doi.org/10.1890/0012-9615(2001)071[0027:LARIOH]2.0.CO;2

* Boose, E. R., Serrano, M. I., & Foster, D. R. (2004). Landscape and regional impacts of hurricanes in Puerto Rico. Ecological Monographs, 74(2), Article 2. https://doi.org/10.1890/02-4057
 
* Holland, G. J. (1980). An Analytic Model of the Wind and Pressure Profiles in Hurricanes. Monthly Weather Review, 108(8), 1212–1218. https://doi.org/10.1175/1520-0493(1980)108<1212:AAMOTW>2.0.CO;2

* Willoughby, H. E. (1995). Normal-Mode Initialization of Barotropic Vortex Motion Models. Journal of the Atmospheric Sciences, 52(24), 4501–4514. https://doi.org/10.1175/1520-0469(1995)052<4501:NMIOBV>2.0.CO;2

* Willoughby, H. E., & Rahn, M. E. (2004). Parametric Representation of the Primary Hurricane Vortex. Part I: Observations and Evaluation of the Holland (1980) Model. Monthly Weather Review, 132(12), 3033–3048. https://doi.org/10.1175/MWR2831.1

* Willoughby, H. E., Darling, R. W. R., & Rahn, M. E. (2006). Parametric Representation of the Primary Hurricane Vortex. Part II: A New Family of Sectionally Continuous Profiles. Monthly Weather Review, 134(4), 1102–1120. https://doi.org/10.1175/MWR3106.1

* Yan, D., & Zhang, T. (2022). Research progress on tropical cyclone parametric wind field models and their application. Regional Studies in Marine Science, 51, 102207. https://doi.org/10.1016/j.rsma.2022.102207
