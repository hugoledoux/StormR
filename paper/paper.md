---
title: 'StormR: A R package to quantify and map the behaviour of winds generated by
  tropical storms and cyclones in space and time'
tags:
- R
- tropical storms
- cyclones
date: "05 June 2023"
output:
  html_document:
    df_print: paged
authors:
- name: Baptiste Delaporte
  affiliation: 1
- name: Thomas Arsouze
  orcid: "0000-0002-8871-6120"
  corresponding: yes
  affiliation: 2, 3
- name: Gunnar Keppel
  orcid: "0000-0001-7092-6149"
  affiliation: 4
- name: Swen Julien
  orcid: "0000-0002-5389-0532"
  affiliation: 5
- name: Christophe Menkes
  orcid: "0000-0002-1457-9696"
  affiliation: 6
- name: Thomas Ibanez
  orcid: "0000-0002-3192-1721"
  affiliation: 3
bibliography: paper.bib
affiliations:
- name: Independent Researcher, France
  index: 1
- name: CIRAD, UMR AMAP, F‐34398 Montpellier, France
  index: 2
- name: AMAP, Univ Montpellier, CIRAD, CNRS, INRAE, IRD, Montpellier, France
  index: 3
- name: UniSA STEM and Future Industries Institute, University of South Australia,
    GPO Box 2471, Adelaide, SA 5001, Australia
  index: 4
- name: Ifremer, Univ. Brest, CNRS, IRD, Laboratoire d'Océanographie Physique et Spatiale
    (LOPS), IUEM, Plouzané, France
  index: 5
- name: ENTROPIE, UMR 9220, IRD, Univ. de la Réunion, CNRS, 101 Promenade Roger Laroque,
    Nouméa, New Caledonia
  index: 6
---

# Summary

`StormR` is an R package allowing to easily extract storm track data, 
to generate wind speed and direction fields, and to compute summary 
statistics characterising the behaviour of winds generated by tropical 
storms and cyclones. By default, we suggest to use the
IBTrACS database [International Best Track Archive for Climate Stewardship] 
(https://www.ncei.noaa.gov/products/international-best-track-archive) 
(Knapp *et al.*, [-@knapp_international_2010], [-@knapp_international_2018]). 
This database provides a fairly comprehensive record of worldwide tropical 
storms and cyclones with a 3-hours temporal resolution since 1841. 
However any storm track data can be used as long as the mandatory fields 
are provided.

Storm track data can be extracted using a specified point location,
a user defined spatial polygon shapefile, a country or a cyclone basin name. 
The main functions of the `StormR` package allow to generate wind speed and 
direction fields as re-constructed from storm track data and a 
parametric cyclone model. Different models and models combination can be chose 
by the user. By default the spatial resolution is set to 2.5 min 
(~4.5 km at the equator), but a finer spatial resolution of 30 s (~1
km at the equator) and coarser spatial resolutions of 5 min (~9 km at the
equator) or 10 min (~18.6 km at the equator) can be set. The temporal 
resolution is set to 1 hour by default but finer spatial resolution of 45 min,
30 min, or 15 min can be set.

Once wind speed is generated for each cell and each time step, `StormR` 
functions can compute summary statistics on wind speed over the lifespan
of a storm. Summary statistics encompass the maximum sustained wind speed,
the power dissipation index or total power dissipated by a tropical storm 
[@emanuel_power_1999; @emanuel_increasing_2005] and the duration of exposure 
to winds reaching defined speed thresholds. By default the duration of exposure
is computed for each Saffir-Simpson Hurricane Scale threshold values for 
tropical cyclone categories, i.e., $33$, $43$, $50$ ,$58$, and $70$ $m.s^{-1}$ 
[@simpson_hurricane_2010], but can be defined by the user.

# Statement of need

Globally, an average of 86 tropical cyclones per year occurred over the past 
four decades [@murakami_detected_2020]. These disturbances can cause severe 
damages to natural and built ecosystems. Climate change has likely increased 
the proportion of category 3-5 tropical cyclones on the Saffir–Simpson 
hurricane wind scale [@simpson_hurricane_2010] over the past four decades and 
climate scientists are also predicting with high confidence that the proportion 
of the most intense and potentially the most destructive tropical cyclones 
(category 4-5) would increase by +10% even if warming is limited to 1.5°C 
[@intergovernmental_panel_on_climate_change_technical_2023]. `StormR` R package
responds to the need of an easy to use tool that helps to better understand and
map damages and potential damages caused by winds generated by storms and 
tropical cyclones.

To our knowledge two R packages `HurreconR` [@Boose_HurreconR_2023] and
`hurricaneexposure` [@Brooke_hurricaneexposure_2020] are available on R CRAN. 
As highlighted by their names, these two packages have a strong focus on the 
North American basin where tropical cyclones are named hurricanes. Another 
important limitation of those packages is that they both rely on a single model 
to reconstruct wind speed. The `HurreconR` package relies on the HURRECON 
model [@boose_landscape_2001; @boose_landscape_2004], a modification of 
the @holland_analytic_1980 model, and the `hurricaneexposure` package relies on
the Willoughby's model [@willoughby_parametric_2006]. Many model exists and 
none of these is the best for all tropical cyclones and storms 
[@yan_research_2022]. Compared to those packages, the `StormR` R package 
allows to reconstruct wind behaviour for tropical storms and cyclones anywhere, 
anytime, and this with a set of models including those used in `HurreconR` 
and `hurricaneexposure` packages.
 
# Example

A `test_dataset` is provided with the `StormR` package. This test data set 
comprises the track data of nine storms that occurred near Vanuatu and 
New Caledonia between 2015-2016 and 2020-2021, respectively. Here we show how 
the behaviour of winds generated by the topical cyclone Pam (2015) near Vanuatu
can be computed.

First, track data are extracted as follows:

```{r}
sds <- defStormsDataset()
st <- defStormsList(sds = sds, loi = "Vanuatu", names = "PAM", verbose = 0)
plotStorms(st)
```

The `spatialBehaviour()` function can compute the different products
(i.e., "Profiles", "MSW", "PDI", "Exposure") either separately or together. 
Here, we compute all three summary statistics together as follows:


```{r}
ss <- spatialBehaviour(st, product = c("MSW", "PDI", "Exposure"), verbose = 0)
ss
```

The `spatialBehaviour()` function returns a `SpatRaster` object with eight
rasters: one for the maximum sustained wind speed (`"MSW"`), one for the power
dissipation index (`"PDI"`), and one for each of the six defaults wind
thresholds values set for the duration of exposure (`"Exposure"`).

```{r}
names(ss)
```

The maximum sustained wind speed can be plotted as follows:

```{r}
plotBehaviour(st, ss$PAM_MSW)
```

The power dissipation index can be plotted as follows:

```{r}
plotBehaviour(st, ss$PAM_PDI)
```

The duration of exposure to wind stronger than 58 $m.s^{-1}$ (i.e.,
Saffir-Simpson's categories 4 and 5) can be plotted as follows:

```{r}
plotBehaviour(st, ss$PAM_Exposure_58)
```







Single dollars ($) are required for inline mathematics e.g. $f(x) = e^{\pi/x}$

Double dollars make self-standing equations:

$$\Theta(x) = \left\{\begin{array}{l}
0\textrm{ if } x < 0\cr
1\textrm{ else}
\end{array}\right.$$

You can also use plain \LaTeX for equations
\begin{equation}\label{eq:fourier}
\hat f(\omega) = \int_{-\infty}^{\infty} f(x) e^{i\omega x} dx
\end{equation}
and refer to \autoref{eq:fourier} from text.

# Citations

Citations to entries in paper.bib should be in
[rMarkdown](http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html)
format.

If you want to cite a software repository URL (e.g. something on GitHub without a preferred
citation) then you can do it with the example BibTeX entry below for @fidgit.

For a quick reference, the following citation commands can be used:
- `@author:2001`  ->  "Author et al. (2001)"
- `[@author:2001]` -> "(Author et al., 2001)"
- `[@author1:2001; @author2:2001]` -> "(Author1 et al., 2001; Author2 et al., 2002)"

# Figures

Figures can be included like this:
![Caption for example figure.\label{fig:example}](figure.png)
and referenced from text using \autoref{fig:example}.

Figure sizes can be customized by adding an optional second parameter:
![Caption for example figure.](figure.png){ width=20% }

# Acknowledgements

We acknowledge contributions from Brigitta Sipocz, Syrtis Major, and Semyeong
Oh, and support from Kathryn Johnston during the genesis of this project.

# References
