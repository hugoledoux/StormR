<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function computes/rasterizes products for each Storm included in a
StormsList, among Maximum Sustained Wind, Power Dissipation Index, Category
exposure and 2D wind speed structures/direction of wind speed for every
observations"><title>Compute indicators of storm behaviour — spatialBehaviour • StormR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute indicators of storm behaviour — spatialBehaviour"><meta property="og:description" content="This function computes/rasterizes products for each Storm included in a
StormsList, among Maximum Sustained Wind, Power Dissipation Index, Category
exposure and 2D wind speed structures/direction of wind speed for every
observations"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">StormR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Behaviour.html">Behaviour</a>
    <a class="dropdown-item" href="../articles/DataSource.html">Data source</a>
    <a class="dropdown-item" href="../articles/Models.html">Models</a>
    <a class="dropdown-item" href="../articles/SpatialBehaviour.html">spatialBehaviour</a>
    <a class="dropdown-item" href="../articles/Storms.html">Storms</a>
    <a class="dropdown-item" href="../articles/TemporalBehaviour.html">temporalBehaviour</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute indicators of storm behaviour</h1>
      
      <div class="d-none name"><code>spatialBehaviour.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes/rasterizes products for each <code>Storm</code> included in a
<code>StormsList</code>, among Maximum Sustained Wind, Power Dissipation Index, Category
exposure and 2D wind speed structures/direction of wind speed for every
observations</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spatialBehaviour</span><span class="op">(</span></span>
<span>  <span class="va">sts</span>,</span>
<span>  product <span class="op">=</span> <span class="st">"MSW"</span>,</span>
<span>  wind_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">33</span>, <span class="fl">42</span>, <span class="fl">49</span>, <span class="fl">58</span>, <span class="fl">70</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Willoughby"</span>,</span>
<span>  asymmetry <span class="op">=</span> <span class="st">"Chen"</span>,</span>
<span>  empirical_rmw <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  space_res <span class="op">=</span> <span class="st">"2.5min"</span>,</span>
<span>  temp_res <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>sts</dt>
<dd><p><code>StormsList</code></p></dd>


<dt>product</dt>
<dd><p>character. Product to compute among:</p><ul><li><p><code>"MSW"</code>: Maximum Sustained Wind</p></li>
<li><p><code>"PDI"</code>: Power Dissipation Index</p></li>
<li><p><code>"Exposure"</code>: hour exposition for wind greater than <code>wind_threshold</code></p></li>
<li><p><code>"Profiles"</code>, 2D wind speed structures of wind speed with wind
direction for each observation</p></li>
</ul><p>Default value is set to <code>"MSW"</code></p></dd>


<dt>wind_threshold</dt>
<dd><p>numeric vector. Minimal wind threshold(s) \(m.s^{-1}\) to
compute <code>"Exposure"</code> product. Ignored if <code>"Exposure"</code> is not part of the
products to compute. Default value is set to Saffir Simpson Hurricane Scale
thresholds</p></dd>


<dt>method</dt>
<dd><p>character. Cyclonic model used to compute <code>product</code>. Must be
either:</p><ul><li><p><code>"Willoughby"</code>: model based on fits performed on cyclonic observations</p></li>
<li><p><code>"Holland"</code>: model based on both basic cyclonic Physics and parameters
fitting according to cyclonic observations</p></li>
<li><p><code>"Boose"</code>: asymmetric model based on Holland model</p></li>
</ul><p>Default value is set to <code>"Willoughby"</code> (See <code>Details</code>)</p></dd>


<dt>asymmetry</dt>
<dd><p>character. Indicates which version of asymmetry to use in
the computations (see <code>Details</code>). Must be either:</p><ul><li><p><code>"Miyazaki"</code>: based on the formula derived in Miyazaki et al. (1962)</p></li>
<li><p><code>"Chen"</code>:  based on the formula derived in Chen (1994)</p></li>
<li><p><code>"None"</code>: no asymmetry is added</p></li>
</ul><p>Default value is set to <code>"Chen"</code>. Ignored if <code>method == "Boose"</code></p></dd>


<dt>empirical_rmw</dt>
<dd><p>logical. Whether to compute the radius of maximum wind
empirically or using the radius of maximum wind from the observations.
Default value is set to <code>FALSE</code>. If <code>TRUE</code>, a formula extracted from
Willoughby et al. 2006 is used to compute rmw</p></dd>


<dt>space_res</dt>
<dd><p>character. Space resolution for the raster(s) to compute.
Either <code>"30sec"</code>, <code>"2.5min"</code>, <code>"5min"</code> or <code>"10min"</code>. Default value is set
to <code>"2.5min"</code></p></dd>


<dt>temp_res</dt>
<dd><p>numeric. Period of time used to interpolate data. Allowed
values are <code>1</code> (60min), <code>0.75</code> (45min), <code>0.5</code> (30min), and <code>0.25</code> (15min).
Default value is set to <code>1</code></p></dd>


<dt>verbose</dt>
<dd><p>numeric. Whether or not the function should display
informations about the process and/or outputs. Allowed values are:</p><ul><li><p><code>0</code>: Nothing is displayed</p></li>
<li><p><code>1</code>: Informations about the process are displayed</p></li>
<li><p><code>2</code>: Outputs are also displayed</p></li>
</ul><p>Default value is set to <code>2</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>SpatRaster stack which provides the desired product computed,
projected in WGS84 and spanning over the extented LOI of the <code>StormsList</code> .
Number of layers depends on the number of <code>Storm</code> available in <code>sts</code> and
also <code>product</code> and <code>temp_res</code> inputs:</p><ul><li><p><code>"MSW"</code> produces one layer per <code>Storm</code>. Name of layer is "STORMNAME_MSW"</p></li>
<li><p><code>"PDI"</code> produces one layer per <code>Storm</code>. Name of layer is "STORMNAME_PDI"</p></li>
<li><p><code>"Exposure"</code> produces one layer for each wind values available
in <code>wind_threshold</code> and for each <code>Storm</code>. Name of layers are
"STORMNAME_Exposure_threshold1", "STORMNAME_Exposure_threshold2"...</p></li>
<li><p><code>"Profiles"</code> produces two layers for each observations
(real and interpolated) and each  <code>Storm</code>. Name of layers are
"STORMNAME_Speed_observation", "STORMNAME_Direction_observation"</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>temp_res</code> input will perform a linear interpolation
of observations to further compute each 2D wind speed structure at each
interpolated observations. For example, if <code>temp_res == 1</code>, it will
generate observations every 1hour between the available observations. Doing
so, 2D wind speed structure is computed and stacked for each observations
(available and interpolated) to compute the desired product(s) afterwards.
If <code>product == "Profiles"</code>, nothing else is performed. Otherwise and
depending on the product(s) to compute, calculations are carried out on the
stack and <code><a href="https://rdrr.io/pkg/terra/man/focal.html" class="external-link">terra::focal</a></code> functions are applied to the final raster(s) to
smooth the result(s).</p>
<p>The Willoughby et al. (2006) model is an empirical model fitted to aircraft
observations. The model considers two regions: inside the eye and at external
radii, for which the wind formulations use different exponents to better match
observations. In this model, the wind speed increases as a power function of the
radius inside the eye and decays exponentially outside the eye after a smooth
polynomial transition across the eyewall (see also Willoughby 1995, Willoughby
et al. 2004).</p>
<p>\(\left\{\begin{aligned}
   v_r &amp;= v_m \times \left(\frac{r}{R_m}\right)^{n} \quad if \quad r &lt; R_m \\
   v_r &amp;= v_m \times \left((1-A) \times e^{-\frac{|r-R_m|}{X1}} + A \times e^{-\frac{|r-R_m|}{X2}}\right) \quad if \quad r \geq R_m \\
   \end{aligned}
   \right.
\)</p>
<p>where \(v_r\) is the radial wind speed (in \(m.s^{-1}\)), \(r\) is the
distance to the eye of the storm (in \(km\)), \(v_m\) is the maximum
sustained wind speed (in \(m.s^{-1}\)), \(R_m\) is the radius of maximum
sustained wind speed (in \(km\)), \(X1 = 287.6 - 1.942 \times v_m +
7.799 \times \ln(R_m) + 1.819 \times |\phi|\), \(X2 = 25\), \(n = 2.1340
+ 0.0077 \times v_m - 0.4522 \times \ln(R_m) - 0.0038 \times |\phi|\), \(A
= 0.5913 + 0.0029 \times v_m - 0.1361 \times \ln(R_m) - 0.0042 \times |\phi|\)
and \(A\ge0\), \(\phi\) is the latitude of the center of the storm.</p>
<p>The Holland (1980) model, widely used in the literature, is based on the
gradient wind balance in mature tropical cyclones. The wind speed distribution
is computed from the circular air pressure field, which can be derived from
the central and environmental pressure and the radius of maximum winds.</p>
<p>\(v_r = \sqrt{\frac{b}{\rho} \times \left(\frac{R_m}{r}\right)^b \times (p_{oci} - p_c) \times e^{-\left(\frac{R_m}{r}\right)^b} + \left(\frac{r \times f}{2}\right)^2} - \left(\frac{r \times f}{2}\right)\)</p>
<p>where \(v_r\) is the radial wind speed (in \(m.s^{-1}\)), \(r\) is the
distance to the eye of the storm (in \(km\)), \(R_m\) is the radius of
maximum sustained wind speed (in \(km\)), \(p_c\) is the pressure at the
centre of the storm (in \(Pa\)), \(p_{oci}\) is the pressure at outermost
closed isobar of the storm (in \(Pa\)), \(\rho\) is the air density set to
\(1.15 kg.m^{-3}\), \(f = 2 \times 7.29 \times 10^{-5} \sin(\phi)\) is the
Coriolis force (in \(N.kg^{-1}\), with \(\phi\) being the latitude),
\(b = \frac{\rho \times e \times v_m^2}{p_{oci} - p_c}\) is the shape
parameter, with \(e\) being the base of natural logarithms ~2.718282 and
\(v_m\) the maximum sustained wind speed (in \(m.s^{-1}\))</p>
<p>The Boose et al. (2004) model, or “HURRECON” model, is a modification of the
Holland (1980) model (see also Boose et al., 2001). In addition to adding
asymmetry, this model treats of water and land differently, using different
surface friction coefficient for each.</p>
<p>\(v_r = F\left(v_m - S \times (1 - \sin(T)) \times \frac{v_h}{2} \right) \times \sqrt{\left(\frac{R_m}{r}\right)^b \times e^{1 - \left(\frac{R_m}{r}\right)^b}}\)</p>
<p>where \(v_r\) is the radial wind speed (in \(m.s^{-1}\)),
\(v_h\) is the storm velocity (in \(m.s^{-1}\)),
\(r\) is the distance to the eye of the storm (in \(km\)),
\(v_m\) is the maximum sustained wind speed (in \(m.s^{-1}\)),
\(R_m\) is the radius of maximum sustained wind speed (in \(km\)),
\(p_c\) is the pressure at the centre of the storm (\(pressure\) in \(Pa\)),
\(p_{oci}\) is the pressure at outermost closed isobar of the storm (in \(Pa\)),
\(\rho = 1.15\) is the air density (in \(kg.m^{-3}\)),
\(b = \frac{\rho \times e \times v_m^2}{p_{oci} - p_c}\) is the shape parameter,
\(F\) is a scaling parameter for friction (\(1.0\) in water, \(0.8\) in land),
\(S\) is a scaling parameter for asymmetry (\(1.0\)),
\(T\) oriented angle (clockwise/counter clockwise in Northern/Southern Hemisphere) between forward trajectory of the storm and a radial line from the eye of the storm to point \(r\),
\(S\) Asymmetry coefficient (usually set to 1)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#Compute MSW product for Pam 2015 in Vanuatu using default settings</span></span></span>
<span class="r-in"><span><span class="va">msw.pam</span> <span class="op">&lt;-</span> <span class="fu">spatialBehaviour</span><span class="op">(</span><span class="va">pam</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Compute PDI product for Storms in sts_nc using Holland model without asymmetry</span></span></span>
<span class="r-in"><span><span class="va">pdi.nc</span> <span class="op">&lt;-</span> <span class="fu">spatialBehaviour</span><span class="op">(</span><span class="va">sts_nc</span>, method <span class="op">=</span> <span class="st">"Holland"</span>, product <span class="op">=</span> <span class="st">"PDI"</span>, asymmetry <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Compute Exposure for Pam 2015 in Vanuatu using default settings</span></span></span>
<span class="r-in"><span><span class="va">exp.pam</span> <span class="op">&lt;-</span> <span class="fu">spatialBehaviour</span><span class="op">(</span><span class="va">pam</span>, product <span class="op">=</span> <span class="st">"Exposure"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Compute profiles for Storms in sts_nc using default settings</span></span></span>
<span class="r-in"><span><span class="va">prof.nc</span> <span class="op">&lt;-</span> <span class="fu">spatialBehaviour</span><span class="op">(</span><span class="va">sts_nc</span>, product <span class="op">=</span> <span class="st">"Profiles"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Baptiste Delaporte, Thomas Ibanez, Gunnar Keppel, Swen Jullien, Christophe Menkes, Thomas Arsouze.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

